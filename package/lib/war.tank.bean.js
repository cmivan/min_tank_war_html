/*************
 * 炸弹对象
 * BY：CM.Ivan
 * EMail：cm.ivan@qq.com
 *************/
function Bean(war){
var _this = new Obstacle(war);
	_this.id = 'bean_' + parseInt(Math.random() * 1000000000);
	_this.parentID = null;
	_this.range = 600;
	_this.timer = 10;
	_this.speed = 10;
	_this.target=0;
	_this.creat=function(){_this.power=_this.powerMax;_this.body=$('\x3c\x64\x69\x76\x3e\x3c\x2f\x64\x69\x76\x3e');_this.body.appendTo('\x62\x6f\x64\x79').attr('\x69\x64',_this.id).css({'\x6c\x65\x66\x74':_this.left,'\x74\x6f\x70':_this.top,'\x77\x69\x64\x74\x68':_this.width+'\x70\x78','\x68\x65\x69\x67\x68\x74':_this.height+'\x70\x78','\x62\x61\x63\x6b\x67\x72\x6f\x75\x6e\x64\x2d\x69\x6d\x61\x67\x65':'\x75\x72\x6c\x28'+_this.img+'\x29','\x62\x61\x63\x6b\x67\x72\x6f\x75\x6e\x64\x2d\x63\x6f\x6c\x6f\x72':'','\x70\x6f\x73\x69\x74\x69\x6f\x6e':'\x61\x62\x73\x6f\x6c\x75\x74\x65','\x62\x61\x63\x6b\x67\x72\x6f\x75\x6e\x64\x2d\x72\x65\x70\x65\x61\x74':'\x6e\x6f\x2d\x72\x65\x70\x65\x61\x74'});_this.obj=$('\x23'+_this.id);if(_this.clas!=null){_this.obj.attr('\x63\x6c\x61\x73\x73',_this.clas)};if(_this.type!=null){_this.obj.attr('\x74\x79\x70\x65',_this.type)};_this.powerBody()};_this.CollisionFocusObj=null;_this.onCollision=function(){var a=false;var b=parseInt(_this.obj.css('\x6c\x65\x66\x74'));var c=parseInt(_this.obj.css('\x74\x6f\x70'));var d=parseInt(_this.obj.css('\x77\x69\x64\x74\x68'));var e=parseInt(_this.obj.css('\x68\x65\x69\x67\x68\x74'));var f=null;var g=war.ScanCollisionObj(_this);_this.CollisionFocusObj=g;if(g!=null){f=g.obj};if(f!=null){var h=f.attr('\x74\x79\x70\x65');var i=f.attr('\x69\x64');var j=parseInt(f.css('\x6c\x65\x66\x74'));var k=parseInt(f.css('\x74\x6f\x70'));var l=parseInt(f.css('\x77\x69\x64\x74\x68'));var m=parseInt(f.css('\x68\x65\x69\x67\x68\x74'));var n=(b<j)&&(j-b<d);var o=(j<b)&&(b-j<l);var p=(c<=k)&&(k-c<e);var q=(k<=c)&&(c-k<m);a=((n||o)&&(p||q))};return a};_this.collision=function(){if(_this.onCollision()){var a=_this.CollisionFocusObj;var b=a.obj.attr('\x69\x64');_this.display();if(a.powerUpdate(_this.attack)||(_this.parentID=='\x74\x61\x6e\x6b\x5f\x63\x6d'&&b=='\x74\x61\x6e\x6b\x5f\x68\x6f\x6d\x65')){a.display();if(b=='\x74\x61\x6e\x6b\x5f\x63\x6d'){war.end()}};if(_this.parentID=='\x74\x61\x6e\x6b\x5f\x63\x6d'){war.echo.errB('\x42\x6f\x6d\x62\x20\x62\x6c\x61\x73\x74\x21');return true}};return false};_this.engine=function(){var a=parseInt(_this.obj.css('\x74\x6f\x70'));var b=parseInt(_this.obj.css('\x6c\x65\x66\x74'));if(war.stop==false&&_this.collision()==false){switch(_this.arrow){case'\x74':a=a-_this.speed;if(a>_this.target){var c=(a-_this.target)/_this.range;_this.obj.css({'\x74\x6f\x70':a+'\x70\x78','\x6f\x70\x61\x63\x69\x74\x79':c})}else{_this.display()};break;case'\x62':a=a+_this.speed;if(a<_this.target){var c=(_this.target-a)/_this.range;_this.obj.css({'\x74\x6f\x70':a+'\x70\x78','\x6f\x70\x61\x63\x69\x74\x79':c})}else{_this.display()};break;case'\x6c':b=b-_this.speed;if(b>_this.target){var c=(b-_this.target)/_this.range;_this.obj.css({'\x6c\x65\x66\x74':b+'\x70\x78','\x6f\x70\x61\x63\x69\x74\x79':c})}else{_this.display()};break;case'\x72':b=b+_this.speed;if(b<_this.target){var c=(_this.target-b)/_this.range;_this.obj.css({'\x6c\x65\x66\x74':b+'\x70\x78','\x6f\x70\x61\x63\x69\x74\x79':c})}else{_this.display()};break}}};_this.move=function(){_this.reArrow();_this.moveID=setInterval(function(){_this.engine()},_this.timer)};_this.display=function(){if(_this.moveID!=null){clearInterval(_this.moveID)};_this.obj.remove();war.allobj.remove(_this);delete _this};
	return _this;
}